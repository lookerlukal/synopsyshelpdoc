<!DOCTYPE HTML>
<html>
<head>
   <title>um8661</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="image analysis,image analysis Zernike expansion of wavefront,ZC4,ZCOE,Zernike expansion of wavefront" />
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />   
   
   <meta http-equiv="X-UA-Compatible" content="IE=8" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <link type="text/css" href="custom.css" rel="stylesheet">

   <style TYPE="text/css" media="screen"> 
      html, body { margin:0; 
             padding:0; 
             overflow: hidden; 
             background: #FFFFFF; 
       } 
html {
  overflow-x: auto; overflow-y: scroll;
}
      div#printheader { display: none; }
      #idheader { width:100%; 
                  height:auto; 
                  padding: 0; 
                  margin: 0; 
       } 
      #idcontent { position:relative }                                               
      #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
      #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
      #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
      #callout-table a {text-decoration: none; color: blue;}
      #callout-table a:visited {text-decoration: none; color: blue;}
      #overview-table a {text-decoration: none; color: black;}
      #overview-table a:visited {text-decoration: none; color: black;}
      #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}      
      #switchtoggles { text-align: right; padding: 0 5px 0 0; font-size: 90%; } 
      p.help-url { margin: 20px 0 5px 0; text-align: center; font-size: 80%; text-decoration: none }
      .sync-toc { color: #ffffff; font-size: 8pt; font-weight: bold; display: none; }
      .sync-toc a { color: #ffffff; text-decoration: none; font-weight: bold;}
      .sync-toc a:visited { color: #ffffff; }
      .sync-toc a:hover { text-decoration: underline; }

   </style>
   <noscript>
   <style type="text/css">
   html, body { overflow: auto; }
   </style> 
   </noscript>
   <style type="text/css" media="print">
      span.f_Heading1 { color: black; }
      #idheader, #printheader img { display:none; }
      #printheader { display: block; margin-top: 20px; }
      #idcontent { margin-top: 10px; position:relative }
   </style>   

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>
   <script type="text/javascript" src="nsh.js"></script>
<!--[if lt IE 7]>
<style type="text/css">
  #idcontent {padding: 0px;} 
  #innerdiv {padding: 10px 5px 5px 10px ;} 
</style> 
<![endif]-->



</head>
<body>


<div id="idcontent"><div id="innerdiv">
<!--ZOOMRESTART-->
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p><a name="zcoe"></a><span class="f_mine" style="font-weight: bold;">8.6.6.1 Zernike Wavefront Polynomial (ZCOE) &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="f_mine" style="font-family: 'Times New Roman';"> </span><span class="f_mine" style="font-family: 'Times New Roman'; text-decoration: underline;"><a href="um867.htm" class="topiclink">Next</a></span><span class="f_mine" style="font-family: 'Times New Roman';"> </span><span class="f_mine" style="font-family: 'Times New Roman'; text-decoration: underline;"><a href="um866.htm" class="topiclink">Previous</a></span><span class="f_mine" style="font-family: 'Times New Roman';"> </span><span class="f_mine" style="font-family: 'Times New Roman'; text-decoration: underline;"><a href="um.htm#um_contents" class="topiclink">TOC</a></span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">To fit the wavefront to a Zernike polynomial series, as described in section </span><span class="f_mine" style="text-decoration: underline;"><a href="um33226.htm" class="topiclink">3.3.2.2.6</a></span><span class="f_mine">, the input is</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine" style="text-indent: 48px;"><span class="f_mine" style="font-family: 'Times New Roman'; font-weight: bold;">{</span><span class="f_mine" style="font-weight: bold;"> ZCOE / ZC4 } { </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">ICOL</span><span class="f_mine" style="font-weight: bold;"> / P } </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">HBAR</span><span class="f_mine" style="font-weight: bold;"> 0 0 </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">GBAR</span><span class="f_mine" style="font-weight: bold;"> [ FULL [ RMS ] ].</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The 36 terms discussed in the referenced section are displayed, plus the coefficient for a constant term, printed as number 37. &nbsp;The </span><span class="f_mine" style="font-weight: bold;">ZCOE</span><span class="f_mine"> coefficients at present cannot be used by </span><span class="f_mine" style="font-weight: bold;">DIFF</span><span class="f_mine">. &nbsp;If you run </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;"><a href="um866.htm#coe" class="topiclink">COE</a></span><span class="f_mine"> or </span><span class="f_mine" style="font-weight: bold;">ZCOE</span><span class="f_mine"> and then </span><span class="f_mine" style="font-style: italic;">immediately</span><span class="f_mine"> run </span><span class="f_mine" style="text-decoration: underline;"><a href="um861.htm#pupil" class="topiclink">PUPIL</a></span><span class="f_mine">, you get a plot of the wavefront described by the polynomial.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The </span><span class="f_mine" style="font-weight: bold;">ZC4</span><span class="f_mine"> option evaluates only the first four terms of the Zernike series. &nbsp;This is intended for cases where the pupil is not a uniform circle, and one wants nevertheless to see the tilt and defocus terms. &nbsp;See </span><span class="f_mine" style="text-decoration: underline;"><a href="um57.htm" class="topiclink">Section 5.7</a></span><span class="f_mine"> for more details.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The </span><span class="f_mine" style="font-weight: bold;">FULL</span><span class="f_mine"> option itemizes the coefficients and displays the polynomial for each, as shown below:</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp; &nbsp; COEFFICIENT &nbsp;ZERNIKE TERM</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp;---------------------------------------------------------------------</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;">&nbsp;</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp;1 &nbsp;-0.543383E-07 R COS(A) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(distortion)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp;2 &nbsp; 0.612461E-01 R SIN(A))</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp;3 &nbsp;-0.134166 &nbsp; &nbsp; 2*R**2-1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(defocus)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp;4 &nbsp;-0.315161 &nbsp; &nbsp; R**2 COS(2A) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(astigmatism)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp;5 &nbsp; 0.139942E-06 R**2 SIN(2A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp;6 &nbsp;-0.100257E-06 (3*R**2-2) R COS(A) &nbsp; (coma)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp;7 &nbsp;-0.359022E-01 (3*R**2-2) R SIN(A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp;8 &nbsp; 0.950251E-01 6*R**4-6*R**2+1 &nbsp; &nbsp; &nbsp; (spherical aberration)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> &nbsp;9 &nbsp; 0.179692E-06 R**3 COS(3A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 10 &nbsp; 0.275242E-01 R**3 SIN(3A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 11 &nbsp;-0.837673E-01 (4*R**2-3) R**2 COS(2A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 12 &nbsp; 0.226484E-06 (4*R**2-3) R**2 SIN(2A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 13 &nbsp;-0.157609E-06 (10*R**4-12*R**2+3) R COS(A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 14 &nbsp;-0.422843E-01 (10*R**4-12*R**2+3) R SIN(A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 15 &nbsp;-0.677008E-02 20*R**6-30*R**4+12*R**2-1</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 16 &nbsp; 0.855502E-03 R**4 COS(4A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 17 &nbsp;-0.119863E-06 R**4 SIN(4A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 18 &nbsp; 0.260765E-06 (5*R**2-4) R**3 COS(3A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 19 &nbsp; 0.301007E-02 (5*R**2-4) R**3 SIN(3A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 20 &nbsp; 0.753338E-04 (15*R**4-20*R**2+6) R**2 COS(2A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 21 &nbsp; 0.302299E-06 (15*R**4-20*R**2+6) R**2 SIN(2A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 22 &nbsp;-0.180108E-06 (35*R**6-60*R**4+30*R**2-4) R COS(A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 23 &nbsp; 0.157635E-02 (35*R**6-60*R**4+30*R**2-4) R SIN(A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 24 &nbsp;-0.513180E-03 70*R**8-140*R**6+90*R**4-20*R**2+1</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 25 &nbsp; 0.184486E-07 R**5 COS(5A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 26 &nbsp;-0.262031E-04 R**5 SIN(5A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 27 &nbsp; 0.973738E-04 (6*R**2-5) R**4 COS(4A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 28 &nbsp;-0.168155E-06 (6*R**2-5) R**4 SIN(4A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 29 &nbsp; 0.330699E-06 (21*R**4-30*R**2+10) R**3 COS(3A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 30 &nbsp; 0.904492E-04 (21*R**4-30*R**2+10) R**3 SIN(3A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 31 &nbsp; 0.650909E-04 (56*R**6-105*R**4+60*R**2-10) R**2 COS(2A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 32 &nbsp; 0.372422E-06 (56*R**6-105*R**4+60*R**2-10) R**2 SIN(2A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 33 &nbsp;-0.252197E-06 (126*R**8-280*R**6+210*R**4-60*R**2+5) R COS(A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 34 &nbsp; 0.214775E-04 (126*R**8-280*R**6+210*R**4-60*R**2+5) R SIN(A)</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 35 &nbsp;-0.112757E-05 252.0*R10-630.0*R8+560.0*R6-210.0*R4+30.0*R2-1.0</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 36 &nbsp; 0.135635E-06 924.0*R12-2772.0*R10+3150.0*R8-1680.0*R6+420.0*R4-2.0*R2+1.0</span></p>
<p><span style="font-size: 9pt; font-family: 'Courier New'; font-weight: bold;"> 37 &nbsp;-0.235450 &nbsp; &nbsp; 1</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The </span><span class="f_mine" style="font-weight: bold;">RMS</span><span class="f_mine"> option normalizes the terms so that the RMS value over the unit disk = 1. &nbsp;If this option is not requested, the normalization gives a </span><span class="f_mine" style="font-style: italic;">peak</span><span class="f_mine"> value of 1 at the edge of the disk.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">ZCOE honors apertures and vignetting.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">Individual terms in the expansion may be controlled in the AANT file with the mnemonic </span><span class="f_mine" style="text-decoration: underline;"><a href="um10314.htm" class="topiclink">ZCOE</a></span><span class="f_mine" style="font-family: 'Times New Roman';">.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The </span><span class="f_mine" style="text-decoration: underline;"><a href="um861.htm#pupil" class="topiclink">PUPIL</a></span><span class="f_mine"> feature will model the wavefront with the ZCOE coefficients instead of with real raytracing if the ZCOE command immediately precedes the PUPIL command.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p><span style="width:48px">&nbsp;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-size: 11pt; font-family: 'Times New Roman'; text-decoration: underline;"><a href="um867.htm" class="topiclink">Next</a></span><span style="font-size: 11pt; font-family: 'Times New Roman';"> </span><span style="font-size: 11pt; font-family: 'Times New Roman'; text-decoration: underline;"><a href="um.htm#um_contents" class="topiclink">TOC</a></span><span style="font-size: 11pt; font-family: 'Times New Roman';"> </span></p>

<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript">


</script>
</body>
</html>
