<!DOCTYPE HTML>
<html>
<head>
   <title>um2631</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="VFIELD vignetted pupil,vignetted pupil, entering data for" />
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />   
   
   <meta http-equiv="X-UA-Compatible" content="IE=8" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <link type="text/css" href="custom.css" rel="stylesheet">

   <style TYPE="text/css" media="screen"> 
      html, body { margin:0; 
             padding:0; 
             overflow: hidden; 
             background: #FFFFFF; 
       } 
html {
  overflow-x: auto; overflow-y: scroll;
}
      div#printheader { display: none; }
      #idheader { width:100%; 
                  height:auto; 
                  padding: 0; 
                  margin: 0; 
       } 
      #idcontent { position:relative }                                               
      #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
      #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
      #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
      #callout-table a {text-decoration: none; color: blue;}
      #callout-table a:visited {text-decoration: none; color: blue;}
      #overview-table a {text-decoration: none; color: black;}
      #overview-table a:visited {text-decoration: none; color: black;}
      #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}      
      #switchtoggles { text-align: right; padding: 0 5px 0 0; font-size: 90%; } 
      p.help-url { margin: 20px 0 5px 0; text-align: center; font-size: 80%; text-decoration: none }
      .sync-toc { color: #ffffff; font-size: 8pt; font-weight: bold; display: none; }
      .sync-toc a { color: #ffffff; text-decoration: none; font-weight: bold;}
      .sync-toc a:visited { color: #ffffff; }
      .sync-toc a:hover { text-decoration: underline; }

   </style>
   <noscript>
   <style type="text/css">
   html, body { overflow: auto; }
   </style> 
   </noscript>
   <style type="text/css" media="print">
      span.f_Heading1 { color: black; }
      #idheader, #printheader img { display:none; }
      #printheader { display: block; margin-top: 20px; }
      #idcontent { margin-top: 10px; position:relative }
   </style>   

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>
   <script type="text/javascript" src="nsh.js"></script>
<!--[if lt IE 7]>
<style type="text/css">
  #idcontent {padding: 0px;} 
  #innerdiv {padding: 10px 5px 5px 10px ;} 
</style> 
<![endif]-->



</head>
<body>


<div id="idcontent"><div id="innerdiv">
<!--ZOOMRESTART-->
<p class="p_mine"><span class="f_mine" style="font-weight: bold;">2.6.3.1 Setting Expected Pupil Vignetting (VFIELD)</span><span class="f_mine"> &nbsp;   &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="f_mine" style="font-family: 'Times New Roman'; text-decoration: underline;"><a href="um263.htm" class="topiclink">Previous</a></span><span class="f_mine" style="font-family: 'Times New Roman';"> </span><span class="f_mine" style="font-family: 'Times New Roman'; text-decoration: underline;"><a href="um264.htm" class="topiclink">Next</a></span><span class="f_mine" style="font-family: 'Times New Roman';"> </span><span class="f_mine" style="font-family: 'Times New Roman'; text-decoration: underline;"><a href="um.htm#um_contents" class="topiclink">TOC</a></span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">In addition to the three WAP pupil options there is another option</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine" style="font-weight: bold;">VFIELD </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">NHBAR</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine" style="font-weight: bold; text-decoration: underline;">HBAR</span><span class="f_mine" style="font-weight: bold;"> </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">VYP</span><span class="f_mine" style="font-weight: bold;"> </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">VYN</span><span class="f_mine" style="font-weight: bold;"> </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">VIGX</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine" style="font-weight: bold;">…</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine" style="font-weight: bold;">(up to nine field points)</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">which allows you to set in advance the expected pupil vignetting at up to nine field points. &nbsp;NHBAR is the number of points, VYP and VYN are the fractional upper and lower limits in the Y-dimension, and VIGX is the fractional limit in the X-dimension (relative to the paraxial pupil dimensions). &nbsp;The list of field points must be non-negative and in increasing order. &nbsp;For raytracing at values of HBAR not in the VFIELD list, linear interpolation is performed to determine the vignetting used. &nbsp;These data may be entered in a dialog that is found as a link in the </span><span class="f_mine" style="text-decoration: underline;"><a href="hidd_sys.htm#sys" class="topiclink">SYS</a></span><span class="f_mine"> or the </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;"><a href="hidd_pupilwizard.htm" class="topiclink">Pupil Wizard</a></span><span class="f_mine"> dialogs, or calculated automatically by the </span><span class="f_mine" style="text-decoration: underline;"><a href="um524.htm#fvf" class="topiclink">FVF</a></span><span class="f_mine"> command. &nbsp;Although it is not a requirement, we advise that the first field point should be at HBAR = 0, with no vignetting. &nbsp;The default clear aperture calculation utilizes all of the entered HBARs, and sometimes the on-axis beam requires larger apertures somewhere. &nbsp;This will ensure it is examined too.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><img src="um2f6.png" width="389" height="338" alt="um2f6" style="width:389px;height:338px;border:none"></p>
<p class="p_mine"><span class="f_mine">The figure above shows how the dimensions are defined. &nbsp;The outer circle represents the pupil with no VFIELD parameters in effect. &nbsp;Suppose you want the pupil at full field reduced to 70% of nominal in the +Y direction, 60% in the –Y direction, and want no vignetting in the X direction, as indicated by the arcs drawn in the upper and lower part of the pupil. &nbsp;For this case one would enter</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine">VFIELD 2</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine">0 1 1 1</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine">1 .7 .6 1</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">to specify a two-field VFIELD setup. &nbsp;The on-axis point has no vignetting, since all arguments are 1.0, while the full-field point is vignetted as shown in the picture. &nbsp;The chief ray is taken midway between the upper and lower vignetting points, in this case at a point 0.05 up from the nominal pupil center.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The input to VFIELD is defined in the meridional plane, and if you analyze an image that is not in this plane (with a nonzero GBAR) the vignetted pupil shape is rotated as necessary to produce the pupil seen at that field point – provided that the field is either circular or square. &nbsp;If this is not the case, then the VFIELD is not recommended, and the WAP options should be used instead.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The input parameters for a given pattern of vignetting do not depend on whether the paraxial object height is positive or negative. &nbsp;Thus the VFIELD data that work for a positive object height are exactly the same as those for a negative height.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">All features of SYNOPSYS will reduce the pupil to these amounts whenever tracing rays. &nbsp;In particular </span><span class="f_mine" style="text-decoration: underline;"><a href="um62.htm#cap" class="topiclink">CAP</a></span><span class="f_mine"> will trace the upper and lower rays (reduced as above) at all of the HBARs given in the VFIELD input, when finding soft clear apertures. &nbsp;Using this feature in conjunction with the </span><span class="f_mine" style="text-decoration: underline;"><a href="um32.htm#cfix" class="topiclink">CFIX</a></span><span class="f_mine"> command is a useful way of determining hard apertures that give a desired vignetting distribution. &nbsp;The inverse function, which determines the VFIELD set that corresponds to a given set of hard apertures is implemented with the </span><span class="f_mine" style="text-decoration: underline;"><a href="um524.htm#fvf" class="topiclink">FVF</a></span><span class="f_mine"> (Find VField) command. &nbsp;The combination of VFIELD, CAP, CFIX, CFREE, and FVF commands are very useful tools for designing optical systems which would benefit from a certain amount of vignetting.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">To summarize: </span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine" style="margin: 0px 38px 0px 38px;"><span class="f_mine">FVF finds the VFIELD data for a particular set of apertures and field points.</span></p>
<p class="p_mine" style="margin: 0px 38px 0px 38px;"><span class="f_mine">VFIELD lets you set those data yourself.</span></p>
<p class="p_mine" style="margin: 0px 38px 0px 38px;"><span class="f_mine">CAP shows you the current aperture data, and finds soft CAOs.</span></p>
<p class="p_mine" style="margin: 0px 38px 0px 38px;"><span class="f_mine">CFIX sets the apertures to the current soft CAOs, which reflect the VFIELD.</span></p>
<p class="p_mine" style="margin: 0px 38px 0px 38px;"><span class="f_mine">CFREE makes all apertures soft (so they float with the design).</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">By default the chief ray passes through the center of the pupil vignetted by VFIELD. &nbsp;Since no ray searching is needed to determine the extent of the pupil, this option executes very quickly, and may be the preferred pupil model in many cases.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">VFIELD is incompatible with all WAPs. &nbsp;The real pupil option automatically goes into effect unless the stop has been assigned to surface 1. &nbsp;In that case, the paraxial chief ray is taken from the entered value of YP1, if any, and the VFIELD data modify the size of the real pupil but do not activate a real-ray chief-ray search. &nbsp;In this way, you can define a virtual stop location, and by varying the paraxial quantity YP1 you can find the best stop position – and at the same time implement an expected degree of vignetting via the VFIELD data. &nbsp;The </span><span class="f_mine" style="text-decoration: underline;"><a href="um524.htm#fvf" class="topiclink">FVF</a></span><span class="f_mine"> feature is disabled in this mode, however, and you must assign a real pupil before you can use it. &nbsp;If you use this procedure, you can use the </span><span class="f_mine" style="text-decoration: underline;"><a href="um32.htm#cfix" class="topiclink">CFIX</a></span><span class="f_mine"> option to set hard apertures everywhere, and then assign the real stop surface. &nbsp;Then the FVF command will create the VFIELD data you need. </span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">We stress that the VFIELD option is intended only for cases where the power of WAP 3 is required, but you want to avoid the overhead of that more comprehensive search. &nbsp;The vignetting parameters then apply only to that lens, with those clear apertures. &nbsp;If the lens form is changing appreciably, as in the initial stages of optimization, then this option may not be appropriate since the specified vignetting may not be physically realizable and will most likely change as the lens changes. &nbsp;In other words, do not use VFIELD unless you are certain that the entered vignetting pattern will actually occur with the physical lenses.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">It is much simpler, and often appropriate, to use the </span><span class="f_mine" style="text-decoration: underline;"><a href="um10311.htm#vset" class="topiclink">VSET</a></span><span class="f_mine"> option during optimization, instead of the VFIELD. &nbsp;See the </span><span class="f_mine" style="text-decoration: underline;"><a href="um263.htm#wap_vfield" class="topiclink">previous</a></span><span class="f_mine"> section for a discussion of the alternatives.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">All pupil options in SYNOPSYS require that the chief ray physically trace through the system, and some options (PUPIL 3 and 4 in </span><span class="f_mine" style="text-decoration: underline;"><a href="um84.htm#trace" class="topiclink">TRACE</a></span><span class="f_mine">, for example) require that it be unvignetted as well. &nbsp;It is therefore wise to define the pupils so that this is the case.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The WAP option is removed by any subsequent entry of APS. &nbsp;Here is a sample of the input to establish a 2-field VFIELD:</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine">CHG</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine">VFIELD &nbsp; 2</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine"> &nbsp; &nbsp; 0 &nbsp;1 1 1</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine"> &nbsp; &nbsp; 1 &nbsp;.9 .8 .95</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine">END</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">Here we give no vignetting at all at the on-axis point, and reduce the full-field pupil to .9 times the nominal size in +Y, .8 times nominal at -Y, and specify a reduction in X of .95 of nominal at full field.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">It is possible to specify a pupil that is reduced in size and decentered anywhere you wish on the Y-axis. &nbsp;Here is an example sent to us recently:</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><img src="um2f7.png" width="446" height="308" alt="um2f7" style="width:446px;height:308px;border:none"></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">Here, to get this pupil shape at full field, one would enter</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine">VFIELD 2</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine">0 1 1 1</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine">1 0.8 -0.2 0.3</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">where the negative value of VYN goes to the “wrong” side of the center. &nbsp;The chief ray in all cases is midway between the upper and lower extent of the pupil.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The comments in </span><span class="f_mine" style="text-decoration: underline;"><a href="um261.htm#protate" class="topiclink">Section 2.6.1</a></span><span class="f_mine">, which describe how the entrance pupil is rotated for skew field points if the real pupil option is used, apply equally to the VFIELD option, which enables the real pupil.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">A final complication needs to be addressed. &nbsp;If you define the pupil at, say, the full-field point with your VFIELD data, you expect that the pattern at the opposite side of the field will be the same, but rotated 180 degrees. &nbsp;This is in fact what you get – but now you have to be clear at </span><span class="f_mine" style="font-style: italic;">which</span><span class="f_mine"> field point your entered data apply directly. &nbsp;The rule is simple: &nbsp;tracing in the meridional plane, if the object point is on the +Y axis, then the pattern you enter applies just as you defined it. &nbsp;If that point is below the origin, because of the sign of YPP0, then the pattern is rotated. &nbsp;This rule applies whenever a real pupil is in effect, as discussed in </span><span class="f_mine" style="text-decoration: underline;"><a href="um261.htm" class="topiclink">Section 2.6.1</a></span><span class="f_mine" style="font-family: 'Times New Roman';">.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">To remove a VFIELD declaration, enter any of the WAP options, or use the Pupil Wizard (MPW).</span></p>
<p class="p_p2-10"><span class="f_p2-10">&nbsp;</span></p>
<p><span style="font-size: 11pt; font-family: 'Times New Roman';">  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-size: 11pt; font-family: 'Times New Roman'; text-decoration: underline;"><a href="um264.htm" class="topiclink">Next</a></span><span style="font-size: 11pt; font-family: 'Times New Roman';"> </span><span style="font-family: 'Times New Roman'; text-decoration: underline;"><a href="um263.htm" class="topiclink">P</a></span><span style="font-size: 11pt; font-family: 'Times New Roman'; text-decoration: underline;"><a href="um263.htm" class="topiclink">revious</a></span><span style="font-size: 11pt; font-family: 'Times New Roman';"> </span><span style="font-size: 11pt; font-family: 'Times New Roman'; text-decoration: underline;"><a href="um.htm#um_contents" class="topiclink">TOC</a></span></p>

<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript">


</script>
</body>
</html>
