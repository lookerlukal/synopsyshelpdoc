<!DOCTYPE HTML>
<html>
<head>
   <title>um868</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="image analysis,image analysis wavefront variance,OFVARIANCE,QVAR,Strehl ratio, with VARIANCE,VARIANCE" />
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />   
   
   <meta http-equiv="X-UA-Compatible" content="IE=8" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <link type="text/css" href="custom.css" rel="stylesheet">

   <style TYPE="text/css" media="screen"> 
      html, body { margin:0; 
             padding:0; 
             overflow: hidden; 
             background: #FFFFFF; 
       } 
html {
  overflow-x: auto; overflow-y: scroll;
}
      div#printheader { display: none; }
      #idheader { width:100%; 
                  height:auto; 
                  padding: 0; 
                  margin: 0; 
       } 
      #idcontent { position:relative }                                               
      #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
      #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
      #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
      #callout-table a {text-decoration: none; color: blue;}
      #callout-table a:visited {text-decoration: none; color: blue;}
      #overview-table a {text-decoration: none; color: black;}
      #overview-table a:visited {text-decoration: none; color: black;}
      #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}      
      #switchtoggles { text-align: right; padding: 0 5px 0 0; font-size: 90%; } 
      p.help-url { margin: 20px 0 5px 0; text-align: center; font-size: 80%; text-decoration: none }
      .sync-toc { color: #ffffff; font-size: 8pt; font-weight: bold; display: none; }
      .sync-toc a { color: #ffffff; text-decoration: none; font-weight: bold;}
      .sync-toc a:visited { color: #ffffff; }
      .sync-toc a:hover { text-decoration: underline; }

   </style>
   <noscript>
   <style type="text/css">
   html, body { overflow: auto; }
   </style> 
   </noscript>
   <style type="text/css" media="print">
      span.f_Heading1 { color: black; }
      #idheader, #printheader img { display:none; }
      #printheader { display: block; margin-top: 20px; }
      #idcontent { margin-top: 10px; position:relative }
   </style>   

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>
   <script type="text/javascript" src="nsh.js"></script>
<!--[if lt IE 7]>
<style type="text/css">
  #idcontent {padding: 0px;} 
  #innerdiv {padding: 10px 5px 5px 10px ;} 
</style> 
<![endif]-->



</head>
<body>


<div id="idcontent"><div id="innerdiv">
<!--ZOOMRESTART-->
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p><a name="variance"></a><span class="f_mine" style="font-weight: bold;">8.6.8 Wavefront Variance (VAR), VFOCUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="f_mine" style="font-family: 'Times New Roman';"> </span><span class="f_mine" style="font-family: 'Times New Roman'; text-decoration: underline;"><a href="um869.htm" class="topiclink">Next</a></span><span class="f_mine" style="font-family: 'Times New Roman';"> </span><span class="f_mine" style="font-family: 'Times New Roman'; text-decoration: underline;"><a href="um867.htm" class="topiclink">Previous</a></span><span class="f_mine" style="font-family: 'Times New Roman';"> </span><span class="f_mine" style="font-family: 'Times New Roman'; text-decoration: underline;"><a href="um.htm#um_contents" class="topiclink">TOC</a></span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The entry</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine" style="text-indent: 48px;"><span class="f_mine" style="font-weight: bold;">[Q]VARIANCE { </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">ICOL</span><span class="f_mine" style="font-weight: bold;"> / M / P ) </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">HBAR</span><span class="f_mine" style="font-weight: bold;"> </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">NRYS</span><span class="f_mine" style="font-weight: bold;"> 0 </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">GBAR</span><span class="f_mine" style="font-weight: bold;"> [ </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">XIP</span><span class="f_mine" style="font-weight: bold;"> </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">YIP</span><span class="f_mine" style="font-weight: bold;"> ]</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">will calculate the wavefront variance, standard deviation, Strehl ratio, and RMS error for the given field and color.  </span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">This feature may also be run interactively from the dialog </span><span class="f_mine" style="font-weight: bold;">MDI</span><span class="f_mine">, and the variance may be controlled in optimization with the request </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;"><a href="um10311.htm" class="topiclink">GNV</a></span><span class="f_mine" style="font-family: 'Times New Roman';">. </span><span class="f_mine" style="font-weight: bold;">GPV</span><span class="f_mine">, and </span><span class="f_mine" style="font-weight: bold;">IPVAR</span><span class="f_mine">.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">For most of these calculations, the center of the reference sphere is at the diffraction image point, rather than at the principal-ray point. &nbsp;This is the location where the weighted variance has a minimum, and it corresponds approximately to the position of the central peak of the diffraction pattern. &nbsp;The approximation is fairly accurate as long as the OPD errors do not exceed about one wave. &nbsp;It is shifted from the chief ray in cases where the image has non-symmetrical aberrations. &nbsp;This center position, relative to the principal ray point, may optionally be input with the </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">XIP</span><span class="f_mine"> </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">YIP</span><span class="f_mine"> input. &nbsp;The Strehl ratio is approximately equal to the ratio of the intensity at this point to the intensity of a perfect image, and is strictly valid only for a uniform unobscured aperture. &nbsp;(To see the location of the </span><span class="f_mine" style="font-style: italic;">center of gravity</span><span class="f_mine"> of the image, use the </span><span class="f_mine" style="text-decoration: underline;"><a href="um862.htm#psprd" class="topiclink">PSPRD</a></span><span class="f_mine"> feature.)</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The RMS wavefront error is also listed. The </span><span class="f_mine" style="font-weight: bold;">RMS-CR</span><span class="f_mine"> calculation gives the RMS of the raw wavefront, with the reference at the chief-ray point rather than the image point, while the</span><span class="f_mine" style="font-weight: bold;"> </span><span class="f_mine">standard deviation</span><span class="f_mine" style="font-weight: bold;"> </span><span class="f_mine">(</span><span class="f_mine" style="font-weight: bold;">STD. &nbsp;DEV.</span><span class="f_mine">)</span><span class="f_mine"> calculation takes the image point as the reference. &nbsp;Comparing the RMS-CR with the standard deviation shows how different the two are in any given case. &nbsp;If the image shows a large amount of coma, for example, this difference is large -- and illustrates the importance of making this adjustment when evaluating image quality.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The </span><span class="f_mine" style="font-weight: bold;">M</span><span class="f_mine"> option causes the variance to be computed as the color-weighted average over the wavelengths currently in effect.  </span><span class="f_mine" style="font-weight: bold;">P</span><span class="f_mine"> requests only the primary color. &nbsp;The form </span><span class="f_mine" style="font-weight: bold;">QVAR…</span><span class="f_mine"> prints only the final weighted result, with no intermediate results itemized by color.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">In calculating the wavefront variance, there are three logical locations for the center of the reference sphere: the first-order ideal point (i.e., the real chief ray point), the point which corresponds to the peak of the diffraction pattern on the image surface, and the point which corresponds to the peak of the diffraction pattern in general 3D space (not necessarily on the image surface). &nbsp;These three points coincide in a perfect optical system. &nbsp;If the optical system is not perfect, the points separate. &nbsp;If the original wavefront aberration function is computed using the first-order ideal point (which is the case), then the second point can be found by subtracting the tilt terms from the aberration function (assuming that the magnitude of the aberrations is not unreasonably large). &nbsp;Subtracting both the tilt and defocus terms from the aberration function finds the third point. &nbsp;SYNOPSYS uses the </span><span class="f_mine" style="font-style: italic;">second</span><span class="f_mine"> point, computed for the weighted set of wavelengths, as the center of the reference sphere in the wavefront variance calculation. &nbsp;The <a href="um88.htm#map" class="topiclink">MAP</a> program can map the distortion as influenced by the location of the image points.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">In monochromatic systems, the standard deviation is just the square root of the variance. &nbsp;In multicolor images, we take a different approach: here, the printed value of the S.D. and the Strehl ratio is the weighted average of </span><span class="f_mine" style="font-style: italic;">each</span><span class="f_mine"> of the separate values, taken at the second point, above.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The returned values can be entered as targets in the AANT file, as explained in <a href="um10313.htm" class="topiclink">Section 10.3.1.3</a>.</span><br>
<span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">Another form will plot the data calculated by the variance program as a function of field point. &nbsp;The input is</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine" style="text-indent: 48px;"><span class="f_mine" style="font-weight: bold;">OFVARIANCE </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">NRYS</span><span class="f_mine" style="font-weight: bold;"> </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">MODE</span></p>
<p class="p_mine" style="text-indent: 48px;"><span class="f_mine" style="font-weight: bold;">FIELDS </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">NF</span></p>
<p class="p_mine" style="text-indent: 48px;"><span class="f_mine" style="font-weight: bold;">GBAR </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">GBAR</span></p>
<p class="p_mine" style="text-indent: 48px;"><span class="f_mine" style="font-weight: bold;">ICOL { M / P / </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">NB</span><span class="f_mine" style="font-weight: bold;"> }</span></p>
<p class="p_mine" style="text-indent: 48px;"><span class="f_mine" style="font-weight: bold;">PLOT</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine" style="font-weight: bold; text-decoration: underline;">MODE</span><span class="f_mine"> must be an integer between 1 and 5, and selects the quantity to be plotted.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine" style="text-decoration: underline;">MODE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PLOTS</span></p>
<p class="p_mine"><span class="f_mine">1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Variance</span></p>
<p class="p_mine"><span class="f_mine">2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Standard deviation &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p class="p_mine"><span class="f_mine">3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Strehl ratio</span></p>
<p class="p_mine"><span class="f_mine">4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;X-image point</span></p>
<p class="p_mine"><span class="f_mine">5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Y-image point</span></p>
<p class="p_mine"><span class="f_mine">6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RMS wavefront error &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The number of fields requested must be between 2 and 21. &nbsp;The GBAR entry is valid only if the lens has a skew field defined, and the requested color must exist in the lens. &nbsp;As usual, &quot;M&quot; requests analysis in all defined colors, while &quot;P&quot; requests just the principal color. &nbsp;The result is printed and plotted. &nbsp;The data give the X and Y location, in inches, of each point on the plot, and the value of the selected quantity.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p><a name="vfocus"></a><span class="f_mine">The command</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine" style="margin: 0px 0px 0px 48px;"><span class="f_mine" style="font-weight: bold;">VFOCUS { </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">ICOL</span><span class="f_mine" style="font-weight: bold;"> / M / P ) </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">HBAR</span><span class="f_mine" style="font-weight: bold;"> </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">NRYS</span><span class="f_mine" style="font-weight: bold;"> 0 </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">GBAR</span><span class="f_mine" style="font-weight: bold;"> [ 0 0 </span><span class="f_mine" style="font-weight: bold; text-decoration: underline;">TVAR</span><span class="f_mine" style="font-weight: bold;"> ]</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">is used to refocus the system so that the variance is minimized. &nbsp;The program will select a parameter to vary according to the following rules:</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">1. &nbsp;If </span><span class="f_mine" style="text-decoration: underline;">TVAR</span><span class="f_mine"> is entered, that thickness number is the variable. &nbsp;The requested thickness must not be controlled by a pickup or solve. &nbsp;The number must be in word 9 of the command. &nbsp;This is recommended only if the last thickness is also not controlled by a solve – since the solve remains in effect, and the thickness variable cannot then vary the paraxial defocus.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">2. &nbsp;If </span><span class="f_mine">TVAR is not entered and the lens is FOCAL with a solve on the last thickness, then the value of </span><span class="f_mine" style="text-decoration: underline;"><a href="um32.htm#bth" class="topiclink">BTH</a></span><span class="f_mine"> is varied. &nbsp;If there is no solve on the last thickness, then that thickness is varied.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">3. &nbsp;If TVAR is not entered and the lens is AFOCAL, the program will put it in </span><span class="f_mine" style="text-decoration: underline;"><a href="um32.htm#accom" class="topiclink">ACCOM</a></span><span class="f_mine"> mode, if it is not already, and will vary the diopters of accommodation.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">These options can be used to create a plot showing the field curve based on real-ray OPDs instead of the central zone ray intercepts used by </span><span class="f_mine" style="text-decoration: underline;"><a href="um74.htm#fcv" class="topiclink">FCV</a></span><span class="f_mine">. &nbsp;For example, suppose your lens has a YMT solve on the last thickness, number 11. &nbsp;Then make a MACro with</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span style="width:48px">&nbsp;</span><span class="f_mine">VFOCUS M AIP 600</span></p>
<p class="p_mine"><span style="width:48px">&nbsp;</span><span class="f_mine">ORD = THICKNESS 11</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">Run this MACro once, and then enter</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span style="width:48px">&nbsp;</span><span class="f_mine">DO MAC FOR AIP = 0 TO 1</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">The system will refocus at each field point (given by the current value of AIP, which changes during the loop) and then pick up the value of the last thickness to show on the plot. &nbsp;(For more information about AI looping, see </span><span class="f_mine" style="text-decoration: underline;"><a href="um15121.htm" class="topiclink">Section 15.1.2.1</a></span><span class="f_mine">.)</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">VFOCUS runs the optimization program in the background, with a single variable and a single aberration, using the </span><span class="f_mine" style="text-decoration: underline;"><a href="um103_11.htm#clink" class="topiclink">CLINK</a></span><span class="f_mine"> optimization feature to call the </span><span class="f_mine" style="text-decoration: underline;"><a href="um868.htm#variance" class="topiclink">VAR</a></span><span class="f_mine"> program to evaluate the wavefront.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p class="p_mine"><span class="f_mine">VAR and VFOCUS may be run interactively from the dialog </span><span class="f_mine" style="font-weight: bold;">MDI</span><span class="f_mine" style="font-family: 'Times New Roman';">.</span></p>
<p class="p_mine"><span class="f_mine">&nbsp;</span></p>
<p><span style="width:48px">&nbsp;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-size: 11pt; font-family: 'Times New Roman'; text-decoration: underline;"><a href="um869.htm" class="topiclink">Next</a></span><span style="font-size: 11pt; font-family: 'Times New Roman';"> </span><span style="font-size: 11pt; font-family: 'Times New Roman'; text-decoration: underline;"><a href="um.htm#um_contents" class="topiclink">TOC</a></span><span style="font-size: 11pt; font-family: 'Times New Roman';"> </span></p>

<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript">


</script>
</body>
</html>
